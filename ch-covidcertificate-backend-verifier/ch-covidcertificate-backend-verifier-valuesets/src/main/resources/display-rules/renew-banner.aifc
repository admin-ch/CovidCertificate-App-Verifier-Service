/*
Check whether the cert signature is about to expire
*/

import "../rule-constants/vaccine.aifc";
import "../rule-constants/test.aifc";
import "../rule-constants/recovery.aifc";

let cutoff = now() + 90#days;

if (payload.h.exp && payload.v.0 && payload.h.iss) {
   if(((payload.h.exp as DateTime) is before (cutoff as DateTime)) && (payload.h.iss in ["CH", "CH BAG"])){
     "showRenewBanner"
   } else {
     undefined
   }
} else {
  undefined
}